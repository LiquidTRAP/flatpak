From: Matthew Leeds <matthew.leeds@endlessm.com>
Date: Thu, 15 Nov 2018 14:10:13 -0800
Subject: dir: Emit better errors for invalid flatpakrepo files

Closes: #2327
Approved by: matthiasclasen
Origin: upstream, 1.1.1, commit:3f13babb5ab9a69947aa5a41b26161585e1d1dab
---
 common/flatpak-dir.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/common/flatpak-dir.c b/common/flatpak-dir.c
index b2f49a0..b5f2721 100644
--- a/common/flatpak-dir.c
+++ b/common/flatpak-dir.c
@@ -10822,7 +10822,8 @@ flatpak_dir_parse_repofile (FlatpakDir   *self,
 
   if (!g_key_file_has_group (keyfile, source_group))
     {
-      flatpak_fail_error (error, FLATPAK_ERROR_INVALID_DATA, _("Invalid .flatpakref"));
+      flatpak_fail_error (error, FLATPAK_ERROR_INVALID_DATA, _("Invalid %s: Missing group ‘%s’"),
+                          from_ref ? ".flatpakref" : ".flatpakrepo", source_group);
       return NULL;
     }
 
@@ -10830,7 +10831,8 @@ flatpak_dir_parse_repofile (FlatpakDir   *self,
                                FLATPAK_REPO_URL_KEY, NULL);
   if (uri == NULL)
     {
-      flatpak_fail_error (error, FLATPAK_ERROR_INVALID_DATA, _("Invalid .flatpakref"));
+      flatpak_fail_error (error, FLATPAK_ERROR_INVALID_DATA, _("Invalid %s: Missing key ‘%s’"),
+                          from_ref ? ".flatpakref" : ".flatpakrepo", FLATPAK_REPO_URL_KEY);
       return NULL;
     }
 
